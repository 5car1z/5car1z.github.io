<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" content="Linux System Administration"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="C.J. Scarlett" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>Shell - C.J. Scarlett</title><link rel="stylesheet" href="/css/main.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--></head><body><header class="head"><h1 class="head-title u-fl"><a href="/">C.J. Scarlett</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a href="/" class="head-nav__link">Home</a></li><li class="head-nav__item"><a href="/topics" class="head-nav__link">Topics</a></li><li class="head-nav__item"><a href="/archives" class="head-nav__link">Archives</a></li><li class="head-nav__item"><a href="/misc" class="head-nav__link">Misc</a></li><li class="head-nav__item"><a href="/about" class="head-nav__link">About</a></li><li class="head-nav__item"><a href="/contact" class="head-nav__link">Contact</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time datetime="2018-08-29T23:00:00.000Z" class="post__time">August 30, 2018</time><h1 class="post__title"><a href="/2018/08/30/exa-getting-started/">Switching to Exa — &quot;A modern replacement for ls.&quot;</a></h1></header><div class="post__main echo"><p><img src="https://i.gyazo.com/599eceada0e2a52d18a59b2cc3707798.png" alt="Exa Screenshot"></p>
<h1 id="Preamble"><a href="#Preamble" class="headerlink" title="Preamble"></a>Preamble</h1><p>Everyone’s familiar with <code>ls</code> on the commandline, but have you heard of <a href="https://github.com/ogham/exa" target="_blank" rel="external">‘Exa’</a> </p>
<p>Exa is a modern successor to the list command, designed with modernity in mind and an emphasis on better defaults, native colour support, and awareness of things like metadata, symlinking, and even Git version control. Not to mention it’s lightweight, pretty fast, and comes in one singular binary file. </p>
<p>This post shows how to install Exa on Debian/Ubuntu and Arch Linux, but is primarily for the former. I’m also providing a few aliases you can use to make it more familiar and easier to transition to Exa — should you decide to do so. </p>
<a id="more"></a>
<hr>
<h1 id="What’s-on-Offer"><a href="#What’s-on-Offer" class="headerlink" title="What’s on Offer"></a>What’s on Offer</h1><p>The image at the start of this post shows what Exa looks like, even with minimal to no configuration. As long as you have colour support for your terminal/terminal emulator, all you need to do is install the program and decide which ‘ls-like’ options you want to make use of to display file-system objects. </p>
<p>The main advantages or “features” that Exa offers over the longstanding <code>ls</code> program are conferred best in these descriptions, <a href="https://the.exa.website/" target="_blank" rel="external">taken from the official Exa website</a>:</p>
<p><img src="https://i.gyazo.com/f9454f36a26d7bb1469bdff9b7d8e121.png" alt="Features Screenshot"></p>
<p>There are a fair few other plus points not encapsulated here, but hopefully this gives you an impression of what Exa provides, and hopefully even the incentive to try it out.  </p>
<hr>
<h1 id="1-—-How-to-Install-Exa"><a href="#1-—-How-to-Install-Exa" class="headerlink" title="1 — How to Install Exa"></a>1 — How to Install Exa</h1><p>There are three methods covered: Debian and Ubuntu based binary installation, Arch Linux package installation incl. a helper recommendation, and then a walk-through for the native ‘Rust/Cargo’ package manager. </p>
<p>Methods not included are <a href="https://the.exa.website/install/source" target="_blank" rel="external">compiling from source using the Git repository</a> and the various <a href="https://the.exa.website/install/linux" target="_blank" rel="external">other OS package managers in use like Fedora, Gentoo, OpenSUSE, etc.</a> </p>
<h2 id="a-—-Debian-Ubuntu"><a href="#a-—-Debian-Ubuntu" class="headerlink" title="a) — Debian/Ubuntu"></a>a) — Debian/Ubuntu</h2><blockquote>
<p><strong>Note:</strong> “Support for more package managers (including .debs and Snaps) is coming soon!”</p>
</blockquote>
<p>There’s no official package manager support in this case, so the method here in this section is mostly manual. It’s probably the easiest and quickest however given the circumstances. </p>
<p>Should this option not appeal to your sensibilities try the ‘Rust/Cargo’ route lower down instead. </p>
<p>Start off by making your user’s home directory the active directory. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/ogham/exa/releases" target="_blank" rel="external">Grab the latest version of the Exa binary from GitHub</a>, the URL link below may differ as newer versions of Exa are released, so you may want to update the numbers and or filename below before executing it.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ wget https://github.com/ogham/exa/releases/download/v0.8.0/exa-linux-x86_64-0.8.0.zip</span><br></pre></td></tr></table></figure>
<p>Install the <code>unzip</code> program if you don’t have it already. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install unzip</span><br></pre></td></tr></table></figure>
<p>Unzip the downloaded compressed file (remember your filename may differ in the next command).  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ unzip exa-linux-x86_64-0.8.0.zip</span><br></pre></td></tr></table></figure>
<p>Place this new binary file into an appropriate system location e.g. <code>/usr/local/bin/</code>. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mv exa-linux-x86_64 /usr/<span class="built_in">local</span>/bin/exa</span><br></pre></td></tr></table></figure>
<p>Remove the zipped archive file we downloaded as it’s from here on largely redundant. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rm exa-linux-x86_64-0.8.0.zip</span><br></pre></td></tr></table></figure>
<p>Exa will run and work as intended from here on out!</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ exa --long --header</span><br></pre></td></tr></table></figure>
<p><img src="https://i.gyazo.com/454cb79f601d4e187b3d2ccce2308f68.png" alt="Exa Long &amp; Header"></p>
<p>Due to the fact we’re doing this ‘manually’ it’s necessary to add the <em>manpage</em> for Exa too, which is definitely worth the extra effort. </p>
<p>Acquire the page in question from here:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ wget https://raw.githubusercontent.com/ogham/exa/master/contrib/man/exa.1</span><br></pre></td></tr></table></figure>
<p>Move the manpage file into the system directory for application manpages. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mv exa.1 /usr/share/man/man1/</span><br></pre></td></tr></table></figure>
<p>View the manpage and verify it’s accessible, like you would any other manpage:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ man exa</span><br></pre></td></tr></table></figure>
<p>We’re all done! </p>
<p>Examine the information in this manual to your heart’s content before jumping down to section <strong>2 — Installing Exa Bash Auto-completion</strong>.</p>
<h2 id="b-—-Arch-Linux"><a href="#b-—-Arch-Linux" class="headerlink" title="b) — Arch Linux"></a>b) — Arch Linux</h2><p>This is simpler than some of the other options as it’s available through ‘Pacman’.</p>
<p>Here it is on the Arch Linux website’s package index, if you want to take a look at it:</p>
<blockquote>
<p><strong>Note:</strong> <a href="https://www.archlinux.org/packages/community/x86_64/exa/" target="_blank" rel="external">https://www.archlinux.org/ - Exa Package</a></p>
</blockquote>
<p>Ensure your Pacman package database is synced and up to date.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo pacman -Syy</span><br></pre></td></tr></table></figure>
<p>Then update the actual system package repositories. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo pacman -Syu</span><br></pre></td></tr></table></figure>
<p>Now download and install the <code>exa</code> package alongside all of its required dependencies. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo pacman -S exa</span><br></pre></td></tr></table></figure>
<p>Exa will run and work as intended now. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ exa --long --header</span><br></pre></td></tr></table></figure>
<p><img src="https://i.gyazo.com/454cb79f601d4e187b3d2ccce2308f68.png" alt="Exa Long &amp; Header"></p>
<p>For anyone interested in using an <em>AUR helper</em> in place of the regular <code>pacman</code>. I’d recommend <a href="https://github.com/trizen/trizen" target="_blank" rel="external">Trizen</a> as a popular lightweight solution.  </p>
<p> Jump down to section <strong>“2 — Installing Exa Bash Auto-completion”</strong>.</p>
<h2 id="c-—-Cargo-Package-Installation"><a href="#c-—-Cargo-Package-Installation" class="headerlink" title="c) — Cargo Package Installation"></a>c) — Cargo Package Installation</h2><p>This is from the perspective of a Debian based system.</p>
<p>Start by adding <a href="https://www.rust-lang.org/en-US/install.html" target="_blank" rel="external"><em>Rust</em></a> and its libraries to your system; the programming language Exa’s written in. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl <span class="_">-s</span>Sf https://static.rust-lang.org/rustup.sh | sh</span><br></pre></td></tr></table></figure>
<p>If all goes well (as it should) you’ll receive this confirmation output:</p>
<figure class="highlight bash"><figcaption><span>Output</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Rust is ready to roll.</span><br></pre></td></tr></table></figure>
<p>Bring in the following packages if they’re not already present. </p>
<p>“Cargo” — Rust’s package manager — needs them to successfully compile and install Exa. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install build-essential cmake zlib1g-dev</span><br></pre></td></tr></table></figure>
<p>It’s now possible to actually install Exa with <code>cargo</code>. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cargo install exa</span><br></pre></td></tr></table></figure>
<p>In the event of any errors not anticipated here, check the Cargo installation output on your own setup and download/compile any missing packages before running the previous command again.</p>
<blockquote>
<p><strong>Note:</strong> Appending <code>--verbose</code> to the end of <code>cargo install exa</code> reveals compilation issues in more detail. </p>
</blockquote>
<p>After a successful installation, note this portion of the output messaging:</p>
<figure class="highlight bash"><figcaption><span>Output</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">warning: be sure to add /home/scarlz/.cargo/bin to your PATH to be able to run the installed binaries</span><br></pre></td></tr></table></figure>
<p>Let’s do this now so we can access and run Exa properly as your Linux user:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.profile</span><br></pre></td></tr></table></figure>
<p>Add this entire new block of code to the bottom of the file:</p>
<figure class="highlight bash"><figcaption><span>~/.profile</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># set PATH so it includes user's private cargo bin if it exists</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="_">-d</span> <span class="string">"<span class="variable">$HOME</span>/.cargo/bin"</span> ] ; <span class="keyword">then</span></span><br><span class="line">    PATH=<span class="string">"<span class="variable">$HOME</span>/.cargo/bin:<span class="variable">$PATH</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>Save the new additions and exit out of the file. </p>
<p>Once you start a new shell session the Exa binary is now included in your system’s <code>$PATH</code> variable. Meaning Exa can be run from anywhere in the file-system as this user. </p>
<p>Do this now by running <code>source ~./profile</code> or alternatively by opening a new terminal.</p>
<p> Exa will run and work as intended from here onward: </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ exa --long --header</span><br></pre></td></tr></table></figure>
<p><img src="https://i.gyazo.com/454cb79f601d4e187b3d2ccce2308f68.png" alt="Exa Long &amp; Header"></p>
<p>Move straight on to the next section. </p>
<hr>
<h1 id="2-—-Installing-Exa-Bash-Auto-completion"><a href="#2-—-Installing-Exa-Bash-Auto-completion" class="headerlink" title="2 — Installing Exa Bash Auto-completion"></a>2 — Installing Exa Bash Auto-completion</h1><p>Bash completion itself should be already in place on most Linux systems but if for some reason it isn’t, it can be found (on Debian/Ubuntu) by installing this aptly named package.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install bash-completion</span><br></pre></td></tr></table></figure>
<p>All that’s required is to download and place the Exa auto-completion file into the global <code>/etc/bash_completion.d</code> directory:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo wget https://raw.githubusercontent.com/ogham/exa/master/contrib/completions.bash -O /etc/bash_completion.d/exa-completions.bash</span><br></pre></td></tr></table></figure>
<p>For other shells there’s <a href="https://the.exa.website/install/linux" target="_blank" rel="external">some terse information on where to place the autocompletion on the Exa site</a> that may help (lower down on that page). </p>
<hr>
<h1 id="3-—-Adapting-Shell-Aliases-for-Exa"><a href="#3-—-Adapting-Shell-Aliases-for-Exa" class="headerlink" title="3 — Adapting Shell Aliases for Exa"></a>3 — Adapting Shell Aliases for Exa</h1><p>If like me you’re attached to <code>ls</code> then my suggestion would be the following approach. Which is to convert your existing aliases to Exa equivalents whilst retaining the use of “ls” and its combinations of shorthand alias options e.g. <code>l</code>, <code>la</code>, <code>ll</code>, etc.</p>
<p>The most basic example to use would be <code>ls</code>, except aliased to <code>exa</code>, to show a basic output of existing files in the current directory. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">alias</span> ls=<span class="string">"exa"</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.gyazo.com/4e595bcee17d04ca2b576dd0e40a245d.png" alt="ls"></p>
<p>To show hidden files and <em>dotfiles</em> in the same directory — and this is where these further <code>ls</code> aliasing conventions come in — use Exa with the <code>-a</code> switch, plus my original <code>l</code> alias.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">alias</span> l=<span class="string">"exa -a"</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.gyazo.com/b75b2a5fed98d9bb6848fd95e4d0ed19.png" alt="l"></p>
<p>This one uses <code>-lgh</code> from Exa and my old <code>ll</code> alias from <code>ls</code> to show (in a longer listing format) each file’s group complete with some nice headers for the columns.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">alias</span> ll=<span class="string">"exa -lgh"</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.gyazo.com/49334155f7091ef0bd6bdb3217c56185.png" alt="ll"></p>
<p>The same applies here, except it includes hidden files and ‘dotfiles’. <code>la</code> was the alias variation I chose. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">alias</span> la=<span class="string">"exa -lagh"</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.gyazo.com/05497d6b31d001c3160e8646fb2b6a79.png" alt="la"></p>
<p>Here I’ve taken <code>lt</code> for the <code>-T</code> Exa option, which produces a ‘tree’ style output of the file-system, in the same way the <code>tree</code> program does; except it’s not required as a package with Exa, due to it being built-in already.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">alias</span> lt=<span class="string">"exa -T"</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.gyazo.com/145c3801db79b9fe116e0a5870b18782.png" alt="lt"></p>
<p>A final example using <code>lg</code> adds a column to the listing output shown earlier, that displays the file’s current version control status (see column) in a Git repository — assuming it’s tracked by Git and Git is thereby installed.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">alias</span> lg=<span class="string">"exa -lagh --git"</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.gyazo.com/01d9c72885202958e0fdbad6f86a42a8.png" alt="lg"></p>
<p>Consult the manual for Exa to see how corresponding flags and options function, so you can create your own. <a href="https://the.exa.website/docs/command-line-options" target="_blank" rel="external">This page on the website is also very useful for such purposes.</a></p>
<p>Lastly, these aliases for Exa traditionally go together in your <code>.alias</code> or <code>.bashrc</code> file, to make them persistent and permanent between sessions (most will already know this!). </p>
<p>Usually in a manner similar to:</p>
<figure class="highlight bash"><figcaption><span>~/.alias</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># exa aliasing</span></span><br><span class="line"><span class="built_in">alias</span> ls=<span class="string">"exa"</span></span><br><span class="line"><span class="built_in">alias</span> l=<span class="string">"exa -a"</span></span><br><span class="line"><span class="built_in">alias</span> ll=<span class="string">"exa -lgh"</span></span><br><span class="line"><span class="built_in">alias</span> la=<span class="string">"exa -lagh"</span></span><br><span class="line"><span class="built_in">alias</span> lt=<span class="string">"exa -T"</span></span><br><span class="line"><span class="built_in">alias</span> lg=<span class="string">"exa -lagh --git"</span></span><br></pre></td></tr></table></figure>
<hr>
<p>Learning the wider range of command line options in Exa could be the next step to take, or even tweaking the colours through <a href="https://the.exa.website/docs/colour-themes" target="_blank" rel="external">global environment variables</a> might be appealing. Either way what’s covered here is enough to at least get yourself started. </p>
<p>Any and all missing information you may need is likely divulged on <a href="https://the.exa.website/introduction" target="_blank" rel="external">the official website’s documentation.</a></p>
<hr>
<p><strong>More Information</strong></p>
<ul>
<li><a href="https://the.exa.website/" target="_blank" rel="external">The Official Exa Website</a></li>
<li><a href="https://www.rust-lang.org/en-US/install.html" target="_blank" rel="external">Official Rust Website - Install Rust</a></li>
<li><a href="https://doc.rust-lang.org/cargo/getting-started/installation.html" target="_blank" rel="external">The Cargo Book - Installation</a></li>
</ul>
<blockquote>
<p>Easily deploy an SSD cloud server on <a href="https://www.digitalocean.com/?refcode=e91058dbfc7b" target="_blank" rel="external">Digital Ocean</a> in 55 seconds. Sign up using my link and receive $10.00 in free credit: <a href="https://www.digitalocean.com/?refcode=e91058dbfc7b" target="_blank" rel="external">https://www.digitalocean.com/?refcode=e91058dbfc7b</a></p>
</blockquote>
<p>– Scarlz: <a href="https://twitter.com/5car1z" target="_blank" rel="external">@5car1z</a></p>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/Shell/" class="post__tag__link">Shell</a></li><li class="post__tag__item"><a href="/tags/Linux/" class="post__tag__link">Linux</a></li><li class="post__tag__item"><a href="/tags/Bash/" class="post__tag__link">Bash</a></li></ul><a href="/2018/08/30/exa-getting-started/#disqus_thread" class="post__foot-link u-fr">COMMENTS</a></footer></article><article class="post"><header class="post__head"><time datetime="2015-06-13T23:00:00.000Z" class="post__time">June 14, 2015</time><h1 class="post__title"><a href="/2015/06/14/notes-bash-env-variables/">BASH Environment and Shell Variables</a></h1></header><div class="post__main echo"><p><img src="http://i.imgur.com/qthCSsn.png" alt="Shell Logo"></p>
<h1 id="Preamble"><a href="#Preamble" class="headerlink" title="Preamble"></a>Preamble</h1><p>Variables provide a simple way to share configuration settings between multiple applications and processes in Linux, and are mainly set in either a terminal or shell configuration file upon start up. </p>
<p>They are either environmental or shell variables by convention. Both of which are usually defined using all capital letters. This helps users distinguish environmental variables from within other contexts.</p>
<a id="more"></a>
<hr>
<h1 id="1-–-Terminology"><a href="#1-–-Terminology" class="headerlink" title="1 – Terminology"></a>1 – Terminology</h1><p>As said there are technically one of two categories a variable can fall into:</p>
<p><strong>“Environment variables”</strong> have been defined for use in the current shell and will be inherited by any child shells or processes spawned as a result of the parent. Environmental variables can also be used to pass information into processes that are spawned by the shell.</p>
<p><strong>“Shell variables”</strong> are contained exclusively within the shell in which they were set or defined. They are mostly used to keep track of ephemeral temporal data, like the current working directory in a session. </p>
<h1 id="2-–-Displaying-Variables"><a href="#2-–-Displaying-Variables" class="headerlink" title="2 – Displaying Variables"></a>2 – Displaying Variables</h1><p>To see all currently set <strong>environment variables</strong> in a terminal type:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ printenv</span><br></pre></td></tr></table></figure>
<p>Alternatively the shorter command <code>env</code> works too:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ env</span><br></pre></td></tr></table></figure>
<p>To see individual or specific environment variables and print with standard output use either of the following:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ printenv TERM</span><br></pre></td></tr></table></figure>
<p>Prints multiple variables.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ printenv SHELL USER</span><br></pre></td></tr></table></figure>
<p><code>echo</code> prints contents.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$TERM</span></span><br></pre></td></tr></table></figure>
<p>Which can print multiple variables too.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$LANG</span> <span class="variable">$HOME</span></span><br></pre></td></tr></table></figure>
<p>To output <strong>shell variables</strong> as well as environment variables using <code>set</code> do the following: </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">set</span> | less -N</span><br></pre></td></tr></table></figure>
<p><code>set</code> is usually used to change or unset shell options and parameters but here we have <em>piped</em> the command through less to see what it outputs instead of allowing it to make changes. </p>
<p>The command can be modified to not show the residual bash functions included in the last output (using posix mode). The brackets also indicate that the process will be run in a <em>sub shell</em> so that <code>set</code> does not actually change anything in the current shell’s environment. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ (<span class="built_in">set</span> -o posix; <span class="built_in">set</span>) | less -N</span><br></pre></td></tr></table></figure>
<p>Note that there is no one command for retrieving <strong>only</strong> what we class as shell variables. One way of getting these as output is with a sorted comparison from both of the two previous <code>set</code> and <code>env</code> commands. This is not one hundred percent accurate however. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ comm -23 &lt;(<span class="built_in">set</span> -o posix; <span class="built_in">set</span> | sort) &lt;(env | sort) | less -N</span><br></pre></td></tr></table></figure>
<p>In the last command <code>comm</code> is used to compare the output of <code>set</code> in a sub shell with the output of <code>env</code> in a sub shell, before finally being fed through <code>less</code> .  The two compared outputs are also sorted with <code>sort</code> .</p>
<hr>
<h1 id="3-–-Variable-Definitions"><a href="#3-–-Variable-Definitions" class="headerlink" title="3 – Variable Definitions"></a>3 – Variable Definitions</h1><h2 id="Environment-Variables"><a href="#Environment-Variables" class="headerlink" title="Environment Variables"></a>Environment Variables</h2><p><code>SHELL</code>  – <code>/bin/bash</code></p>
<p>This is how the system knows what shell to be used when interpreting commands. In most Linux systems Bash is the default primary shell, but many others can be installed on the system and assigned to this variable. </p>
<hr>
<p><code>TERM</code> – <code>xterm</code></p>
<p>This specifies the type of terminal to emulate when running the shell. The default in GUI based desktop environments is often <code>linux</code> or <code>xterm</code> .</p>
<hr>
<p><code>USER</code>  – <code>scarlz</code></p>
<p>Is set to the username of the currently logged in Linux user.</p>
<hr>
<p><code>PWD</code> – <code>/etc/apache2</code></p>
<p>Like the <code>pwd</code> command it contains the currently active working directory.</p>
<hr>
<p><code>OLDPWD</code> – <code>/home/scarlz/dotfiles</code></p>
<p>The last working directory the user moved from. The shell uses this when the <code>cd -</code> command is invoked. </p>
<hr>
<p><code>LS_COLORS</code> – <code>*.tar=01;31:*.tgz=01;31:*.arj=01;31:*.taz=01;31:</code></p>
<p>The <code>ls</code> command has built-in colour support used to differentiate between file types and folders. Colour codes are stored in this variable that determine the colours used.  </p>
<hr>
<p><code>PATH</code> – <code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin</code></p>
<p>The shell’s main “Path” variable holds a list of directories that the system will query when looking for commands/programs the user types in. They are checked in the order listed. </p>
<hr>
<p><code>LANG</code> – <code>en_GB.UTF-8</code></p>
<p>The currently set language and localization in use (locales), including character encoding.</p>
<hr>
<p><code>HOME</code> – <code>/home/scarlz</code></p>
<p>The current user’s home directory.</p>
<hr>
<p><code>_</code>  – <code>/usr/bin/printenv</code></p>
<p>The previously executed command and its path. </p>
<hr>
<p><code>EDITOR</code> – <code>vim</code></p>
<p>The shell’s preferred text editor. </p>
<hr>
<p><code>PAGER</code> – <code>more</code></p>
<p>The shell’s preferred pager program. </p>
<hr>
<p><code>MAIL</code> – <code>/var/spool/mail/$LOGNAME</code></p>
<p>Contains the location of incoming email. The traditional path is used as an example here. </p>
<hr>
<h2 id="Shell-Variables"><a href="#Shell-Variables" class="headerlink" title="Shell Variables"></a>Shell Variables</h2><p><code>BASHOPTS</code> </p>
<p>The list of options that the shell included when bash was run. Useful for finding out if the shell environment currently can do what you expect it to. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$BASHOPTS</span></span><br><span class="line">BASHOPTS=checkwinsize:cmdhist:complete_fullquote:expand_aliases:extglob</span><br></pre></td></tr></table></figure>
<hr>
<p><code>BASH_VERSION</code></p>
<p>The version of bash being executed, in human-readable form.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$BASH_VERSION</span></span><br><span class="line">4.3.11(1)-release</span><br></pre></td></tr></table></figure>
<hr>
<p><code>BASH_VERSINFO</code> </p>
<p>Similar to the last variable except in “<em>machine</em>“ readable format. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$BASH_VERSINFO</span></span><br><span class="line">4</span><br></pre></td></tr></table></figure>
<hr>
<p><code>COLUMNS</code> </p>
<p>The number of columns that are being used to draw output to the screen.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$COLUMNS</span></span><br><span class="line">239</span><br></pre></td></tr></table></figure>
<hr>
<p><code>DIRSTACK</code> </p>
<p>The stack of directories that are available with the <code>pushd</code> and <code>popd</code> commands.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$DIRSTACK</span></span><br><span class="line">~</span><br></pre></td></tr></table></figure>
<hr>
<p><code>HISTFILESIZE</code> </p>
<p>Number of lines of command history that gets stored to the file per bash session.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$HISTFILESIZE</span></span><br><span class="line">2000</span><br></pre></td></tr></table></figure>
<hr>
<p><code>HISTSIZE</code> </p>
<p>The number of lines of command history maximum to be stored in memory.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$HISTSIZE</span></span><br><span class="line">1000</span><br></pre></td></tr></table></figure>
<hr>
<p><code>HOSTNAME</code> </p>
<p>The hostname of the computer at this time.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$HOSTNAME</span></span><br><span class="line">scarlz-corsair</span><br></pre></td></tr></table></figure>
<hr>
<p><code>IFS</code> </p>
<p>The internal field separator character that separates input on the command line. By default, this is a space so there is no real output to show as an example command. </p>
<hr>
<p><code>PS1</code> </p>
<p>The primary command prompt’s definition. Defines quint-essentially what your prompt looks like when you start a shell session. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$PS1</span></span><br><span class="line">\[\e]0;\u@\h: \w\a\]<span class="variable">$&#123;debian_chroot:+($debian_chroot)&#125;</span>\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$</span><br></pre></td></tr></table></figure>
<hr>
<p><code>SHELLOPTS</code> </p>
<p>Any shell options that can be or have been set with the set option.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$SHELLOPTS</span></span><br><span class="line">braceexpand:emacs:hashall:histexpand:<span class="built_in">history</span>:interactive-comments:monitor</span><br></pre></td></tr></table></figure>
<hr>
<p><code>UID</code> </p>
<p>The assigned UID of the current user.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$UID</span></span><br><span class="line">1000</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="4-–-Setting-Variables"><a href="#4-–-Setting-Variables" class="headerlink" title="4 – Setting Variables"></a>4 – Setting Variables</h1><h2 id="Shell-Variables-1"><a href="#Shell-Variables-1" class="headerlink" title="Shell Variables"></a>Shell Variables</h2><p>To create a shell variable in the current shell session, specify a name and a value in the same manner as usual in Bash. Adhering to the naming convention of using full capitals for the variable name. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ EXAMPLE_VAR=<span class="string">'hello world!'</span></span><br></pre></td></tr></table></figure>
<p>Note the single quotation marks used since the string content of our variable contains a space. </p>
<p>Also when special characters like <code>!</code> are used in the string, apostrophes must be inserted instead of double quotes to enclose the the string. </p>
<p><code>!</code> is special character in Bash as it is usually used to expand the shell history.</p>
<p>We can see the newly defined variable by using <code>echo</code> :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$EXAMPLE_VAR</span></span><br><span class="line">hello world!</span><br></pre></td></tr></table></figure>
<p>As said this is only a shell variable within the current Bash session and not an environmental variable. </p>
<p>This can be checked by using <code>printenv</code> :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ printenv EXAMPLE_VAR</span><br><span class="line">hello world!</span><br></pre></td></tr></table></figure>
<p><strong>No</strong> output is returned as the definition is not recognised as part of the environment. </p>
<p>Let’s take this as an opportunity to demonstrate a way of accessing the value of any shell or environmental variable.</p>
<p>Remember like in these example that to reference the value of a variable, precede it with a <code>$</code> sign. This is so the shell knows to substitute the name of the variable for it’s content. </p>
<h2 id="Environment-Variables-1"><a href="#Environment-Variables-1" class="headerlink" title="Environment Variables"></a>Environment Variables</h2><p>To create one, export an existing shell variable into the shell’s persistent environment using the  <code>export</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> EXAMPLE_VAR</span><br></pre></td></tr></table></figure>
<p>This time when we check the variable with <code>printenv</code> it will output.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ printenv EXAMPLE_VAR</span><br><span class="line">hello world!</span><br></pre></td></tr></table></figure>
<p>The variable now descends into a sub shell child process and is retained from the parent, test this by starting anew shell session with <code>bash</code> :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ bash</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$EXAMPLE_VAR</span></span><br><span class="line">hello world!</span><br></pre></td></tr></table></figure>
<p>To bypass having to set a variable and then export it to the environment, the process can be combined like this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> INSTANT_ENV_VAR=<span class="string">"instant definition plus export!"</span></span><br></pre></td></tr></table></figure>
<p>Return to the parent shell we came from with <code>exit</code> , and try to <code>echo</code> the previously exported variable:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">exit</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$INSTANT_ENV_VAR</span></span><br></pre></td></tr></table></figure>
<p>Notice <strong>no</strong> output is returned as environment variables can only be passed to child processes, and not the other way around. This is sensible for the most part as it “prevents programs from affecting the operating environment from which they were called”.</p>
<p>Also when you exit back into your main parent shell, the child shell environment is destroyed.</p>
<hr>
<h1 id="5-–-Demoting-and-Unsetting-Variables"><a href="#5-–-Demoting-and-Unsetting-Variables" class="headerlink" title="5 – Demoting and Unsetting Variables"></a>5 – Demoting and Unsetting Variables</h1><p>To change an already set environment variable back into a lesser shell variable use the <code>-n</code> parameter with <code>export</code> :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> -n EXAMPLE_VAR</span><br></pre></td></tr></table></figure>
<p>Now nothing is returned when using <code>printenv</code> on the variable:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ printenv EXAMPLE_VAR</span><br></pre></td></tr></table></figure>
<p>It’s still set as a shell variable so to undefine it completely from this local shell session you can use:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">unset</span> EXAMPLE_VAR</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="6-–-Persistent-Variables"><a href="#6-–-Persistent-Variables" class="headerlink" title="6 – Persistent Variables"></a>6 – Persistent Variables</h1><p>To create predefined variables at login depends upon how bash is started and which configuration file it uses to do so. The deciding factors on which file is used relies on the types of “login shell” that have being initiated by the user.</p>
<p>The types being either:</p>
<ul>
<li>Login <strong>or</strong> Non-Login </li>
<li>Interactive <strong>or </strong> Non-Interactive </li>
</ul>
<p>So the two distinctions that are taken into account are whether the shell is being spawned as a “login” or “non-login” session. As well as whether the session is either an “interactive session” or “non-interactive” session.</p>
<h2 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h2><p>A login shell is a shell session that always begins by authenticating the user. If you are signing into a terminal session or through SSH and authenticate, your shell session will be classed and set as a “login” shell.</p>
<p>A session started as a login session will read configuration details from the <code>/etc/profile</code> file first, and then look for the first login shell configuration file it can find in the user’s home directory. In order to get user-specific configuration details.</p>
<p>These files are the first it can find out of <code>~/.bash_profile</code> , <code>~/.bash_login</code> , and <code>~/.profile</code> .</p>
<hr>
<h2 id="Non-Login"><a href="#Non-Login" class="headerlink" title="Non-Login"></a>Non-Login</h2><p>If you start a new shell session from within your authenticated session, like earlier when we called the <code>bash</code> command from the terminal, a non-login shell session is started. This is as you were were not asked for any authentication details when you started the child shell.</p>
<p>A session defined as a non-login shell will always read  <code>/etc/bash.bashrc</code> and then the user-specific <code>~/.bashrc</code> file to help build its environment.</p>
<hr>
<h1 id="Interactive"><a href="#Interactive" class="headerlink" title="Interactive"></a>Interactive</h1><p>An interactive shell session is a shell session that is attached to a terminal and in use. So a normal session that begins with SSH is usually defined as an interactive login shell. See “Non Interactive” in the next section to see the difference between the two. </p>
<hr>
<h2 id="Non-Interactive"><a href="#Non-Interactive" class="headerlink" title="Non-Interactive"></a>Non-Interactive</h2><p>A non-interactive shell session is one that is not attached to a terminal session, and not currently in use. For example a script run from the command line is usually run in a non-interactive, non-login shell.</p>
<p>Most notable non-interactive shells read the environment variable named  <code>BASH_ENV</code> and read the file specified in this variable to construct the new shell environment.</p>
<hr>
<h2 id="Setting-Environment-Variables-at-Login"><a href="#Setting-Environment-Variables-at-Login" class="headerlink" title="Setting Environment Variables at Login"></a>Setting Environment Variables at Login</h2><p>So there are a variety of circumstances that dictate which of the different files are needed to set predefined variables. </p>
<p>This has it’s advantages and gives a lot of flexibility for specific situations where you might want only certain settings for a login shell, and other different settings in a non-login shell. </p>
<p>Despite this to make things easier and more general, most people most of the time will want the same settings for both scenarios. </p>
<p>Depending upon your Linux distribution and personal setup, usually the login configuration files source the non-login configuration files. Meaning that you don’t have to define the variables in both files and can get away with defining environment variables that you want in both <strong>only</strong> inside the non-login configuration files. They will then be read in both scenarios as they’re sourced in the latter. </p>
<p>It’s also best to set them for your individual user and not system wide. so to make them available to both login and non-login shell sessions define these variables in the <code>~/.bashrc</code> .</p>
<p>An example of the line to set a persistent environment variable in the <code>.bashrc</code> file would look like this:</p>
<figure class="highlight bash"><figcaption><span>~/.bashrc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> EXAMPLE_VAR=<span class="string">'hello world!'</span></span><br></pre></td></tr></table></figure>
<p>Which is the same as before whilst on the command line.</p>
<p>The next time you start a shell session, your environment variable declaration(s) are always read and passed on to the shell’s environment (including subsequent child shells too). </p>
<p>You can force your current session to read the config file at any time by typing in a terminal:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>
<p>To set them in the system wide files if you prefer, do the same except add the variable definition(s) to: <code>/etc/profile</code> ,  <code>/etc/bash.bashrc</code> , or <code>/etc/environment</code> instead. </p>
<hr>
<p><strong>More Information</strong></p>
<ul>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-read-and-set-environmental-and-shell-variables-on-a-linux-vps" target="_blank" rel="external">Digital Ocean - How to Read and Set Environmental and Shell Variables on a Linux VPS</a></li>
<li><a href="https://wiki.archlinux.org/index.php/Environment_variables" target="_blank" rel="external">Arch-wiki - Environment Variables Page</a></li>
</ul>
<blockquote>
<p>Easily deploy an SSD cloud server on <a href="https://www.digitalocean.com/?refcode=e91058dbfc7b" target="_blank" rel="external">Digital Ocean</a> in 55 seconds. Sign up using my link and receive $10.00 in free credit: <a href="https://www.digitalocean.com/?refcode=e91058dbfc7b" target="_blank" rel="external">https://www.digitalocean.com/?refcode=e91058dbfc7b</a></p>
</blockquote>
<p>– Scarlz: <a href="https://twitter.com/5car1z" target="_blank" rel="external">@5car1z</a></p>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/Shell/" class="post__tag__link">Shell</a></li><li class="post__tag__item"><a href="/tags/Bash/" class="post__tag__link">Bash</a></li><li class="post__tag__item"><a href="/tags/Variables/" class="post__tag__link">Variables</a></li></ul><a href="/2015/06/14/notes-bash-env-variables/#disqus_thread" class="post__foot-link u-fr">COMMENTS</a></footer></article><article class="post"><header class="post__head"><time datetime="2015-02-18T00:00:00.000Z" class="post__time">February 18, 2015</time><h1 class="post__title"><a href="/2015/02/18/arch-vm-main/">Arch Linux VM Main System Installation</a></h1></header><div class="post__main echo"><p><img src="http://i.imgur.com/v5cFEBC.png" alt="Arch Linux Logo"></p>
<p>This is a continuation of the previous post on installing the base components of Arch. </p>
<p>Except this time I’m detailing the next steps of setting up the main system environment.  </p>
<a id="more"></a>
<hr>
<h1 id="1-–-Initial-Login"><a href="#1-–-Initial-Login" class="headerlink" title="1 – Initial Login"></a>1 – Initial Login</h1><p>Log into the system we created in the previous post this time on the actual file-system we generated (i.e. without the boot media), using the one and only <em>root</em> account currently in existence. Test to see if you have a working internet connection again by using <code>ping</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ping -c 5 www.google.co.uk</span><br><span class="line">$ ping -c 5 8.8.8.8</span><br></pre></td></tr></table></figure>
<p>If you get <code>ping: unknown host www.google.co.uk</code> or <code>connect: Network is unreachable</code> for either of these commands then you need to do the rest of this step (1). </p>
<p>If everything looks fine and you are sending plus receiving through <code>ping</code> with a working internet connection, then move on to step 2 instead. </p>
<p>Find your Ethernet interface name (virtual VM shared host connection interface in this case) using:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ip link</span><br></pre></td></tr></table></figure>
<p>If you are unsure of the name, your Ethernet interface you are looking for is likely to start with the letter “e”, and unlikely to be “lo” or start with the letter “w”. </p>
<p><img src="http://i.gyazo.com/2742bf027aad981b4e3af4652079026a.png" alt="Ethernet interface name"></p>
<p>In my case my interface was named “eno167777736”. So I’ll use that as the example here.</p>
<p>Next make sure the interface is <em>up</em> and running with this command syntax:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ip link <span class="built_in">set</span> eno16777736 up</span><br></pre></td></tr></table></figure>
<p>Substituting the interface name ID with your own.</p>
<p>Then start and enable <code>dhcpcd.service</code> with <code>systemctl</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl <span class="built_in">enable</span> dhcpcd.service</span><br><span class="line">$ systemctl start dhcpcd.service</span><br></pre></td></tr></table></figure>
<p>Attempt a <code>ping</code> once again and this time it should succeed, with the internet connection working correctly. </p>
<p>If despite this there’s no change, try the previous commands again, but this time specifying the interface name in the command like this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl <span class="built_in">enable</span> dhcpcd@eno16777736.service</span><br><span class="line">$ systemctl <span class="built_in">enable</span> dhcpcd@eno16777736.service</span><br></pre></td></tr></table></figure>
<p>If still no joy here are some resources that might prove useful. Remember these links are not in the context of a VM installation however.</p>
<ul>
<li><a href="https://bbs.archlinux.org/viewtopic.php?id=141420" target="_blank" rel="external">No wired internet after fresh arch install.</a></li>
<li><a href="https://wiki.archlinux.org/index.php/beginners%27_guide#Establish_an_internet_connection" target="_blank" rel="external">Arch Linux Beginner’s Guide - Establishing an internet connection</a></li>
<li><a href="https://wiki.archlinux.org/index.php/Network_configuration#Static_IP_address" target="_blank" rel="external">Arch Linux Beginner’s Guide - Network Configuration</a></li>
</ul>
<hr>
<h1 id="2-–-pacman-conf"><a href="#2-–-pacman-conf" class="headerlink" title="2 – pacman.conf"></a>2 – pacman.conf</h1><p><strong>If</strong> using a 64-bit system begin editing the <code>/etc/pacman.conf</code> with <code>nano</code>. </p>
<blockquote>
<p><strong>If not using a 64 bit system then move onto Step 3 now.</strong></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi /etc/pacman.conf</span><br></pre></td></tr></table></figure>
<p>Now <em>uncomment</em> the two following lines in this file:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[multilib]</span><br><span class="line">Include = /etc/pacman.d/mirrorlist</span><br></pre></td></tr></table></figure>
<p>After doing this write/save to the file and exit it. </p>
<p>When back at the shell prompt sync and refresh repositories with <code>pacman</code> by running:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pacman -Sy</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="3-–-User-Creation"><a href="#3-–-User-Creation" class="headerlink" title="3 – User Creation"></a>3 – User Creation</h1><p>Make another user account here so <em>root</em> isn’t the default account in use all the time (bad practice to do so), whilst at the same time adding it to some groups. </p>
<blockquote>
<p><strong>Note:</strong> There are no spaces present between the groups listed in this next command.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ useradd -m -g users -G wheel,storage,power,sys,adm <span class="_">-s</span> /bin/bash scarlz</span><br></pre></td></tr></table></figure>
<p>Set the password for the new user that has just been created.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ passwd scarlz</span><br></pre></td></tr></table></figure>
<p>Install <code>sudo</code> with <code>pacman</code> <strong>if</strong> it did not install as part of your previous base Arch set-up. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pacman -S sudo</span><br></pre></td></tr></table></figure>
<p>If you ever want to see a list of packages related to a search term, you could type the following command, where the package name specified at the end is the “search term”.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pacman -Ss sudo</span><br></pre></td></tr></table></figure>
<p>Now <code>sudo</code> is installed on the system we need to enable it for users belonging to the <code>wheel</code> group in the <em>sudoers</em> file to gain the privileges. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ EDITOR=vi visudo</span><br></pre></td></tr></table></figure>
<p>Find the “user privilege specification” section and <em>uncomment</em> the following line so it looks like this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%wheel ALL=(ALL) ALL</span><br></pre></td></tr></table></figure>
<p>After doing so hit <code>CTRL+X</code> then <code>y</code> and then  <code>ENTER</code>.</p>
<p>I’m also going to install <em>bash completion</em> here to help out before moving onto the next step. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pacman -S bash-completion</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="4-–-VMware-Tools"><a href="#4-–-VMware-Tools" class="headerlink" title="4 – VMware Tools"></a>4 – VMware Tools</h1><p>I’m using Vmware as my virtualisation software in this instance, so here’s how to install the official VMware tools. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pacman -S base-devel net-tools linux-headers</span><br></pre></td></tr></table></figure>
<p>Press <code>ENTER</code> for the default <code>All</code> if prompted by the <code>base-devel</code> package.</p>
<p>Some <strong>Xorg</strong> Vmware related dependencies.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pacman -S xf86-input-vmmouse xf86-video-vmware mesa</span><br></pre></td></tr></table></figure>
<p>Then, create <em>bogus</em> initialisation directories for the installer:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">for</span> x <span class="keyword">in</span> &#123;0..6&#125;; <span class="keyword">do</span> mkdir -p /etc/init.d/rc<span class="variable">$x</span>.d; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>The VMware installer then needs to be mounted in our Arch system:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mount /dev/cdrom /mnt</span><br></pre></td></tr></table></figure>
<p>If you have errors here make sure your VMware software (Workstation in my case) has the latest tools downloaded and updated, and try running VMware “as an Administrator” if using Windows.   </p>
<blockquote>
<p><a href="https://communities.vmware.com/message/2303222#2303222" target="_blank" rel="external">VMware Tools Stuck Downloading in VMware</a></p>
</blockquote>
<p>After this is successfully mounted extract it to <code>/root</code> .</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tar xf /mnt/VMwareTools*.tar.gz -C /root</span><br></pre></td></tr></table></figure>
<p>Run the perl script to the install the extracted VMware tools.  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ perl /root/vmware-tools-distrib/vmware-install.pl</span><br></pre></td></tr></table></figure>
<blockquote>
<p>You can safely ignore the following build failures:</p>
<ul>
<li>VMNEXT 3 virtual network card</li>
<li><strong>“Warning:</strong> This script could not find mkinitrd or update-initramfs and cannot remake the initrd file!”</li>
</ul>
</blockquote>
<p>Reboot the Virtual Machine:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl reboot</span><br></pre></td></tr></table></figure>
<p>Log in and start VMware Tools:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /etc/init.d/rc6.d/K99vmware-tools start</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="5-–-Xorg"><a href="#5-–-Xorg" class="headerlink" title="5 – Xorg"></a>5 – Xorg</h1><blockquote>
<p><strong>“Xorg is the public, open-source implementation of the X window system version 11. Since Xorg is the most popular choice among Linux users, its ubiquity has led to making it an ever-present requisite for GUI applications, resulting in massive adoption from most distributions.”</strong></p>
</blockquote>
<p>Now comes the part where we are going to install X server.</p>
<blockquote>
<p><strong>Note:</strong> To use Xorg in a Virtual Machine, a minimum of 32MB VGA memory is needed.</p>
</blockquote>
<p>Install Xorg and some of its companion packages using <code>pacman</code> once again like so:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pacman -S xorg-server xorg-xinit xorg-server-utils</span><br></pre></td></tr></table></figure>
<p>Finally in this section install the default X environment to ensure that all the x-org components we’ve installed prior to this are functioning correctly.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pacman -S xorg-twm xorg-xclock xterm</span><br></pre></td></tr></table></figure>
<p>Type <code>startx</code> to run the X environment.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ startx</span><br></pre></td></tr></table></figure>
<p><img src="http://i.gyazo.com/8eafc4c84a56c06ea0ce6cbeaff63732.png" alt="Default X Environment"></p>
<hr>
<h1 id="Display-amp-Window-Manager"><a href="#Display-amp-Window-Manager" class="headerlink" title="Display &amp; Window Manager"></a>Display &amp; Window Manager</h1><p>Another forthcoming post will go into depth on how to install a tiling window manager (bspwm) and configure <code>.xinitrc</code> to serve as a display manager. With the exception of this being done in the context of a live system, and not a VM. </p>
<p>Alternatively find and research another window manager/desktop environment from the Arch-wiki to setup and install. </p>
<blockquote>
<p><a href="https://wiki.archlinux.org/index.php/Window_manager" target="_blank" rel="external">Arch-wiki Window Managers</a><br><a href="https://wiki.archlinux.org/index.php/Desktop_environment" target="_blank" rel="external">Arch-wiki Desktop Environments</a></p>
</blockquote>
<hr>
<p><strong>More Information</strong></p>
<ul>
<li><a href="https://wiki.archlinux.org/index.php/Installing_Arch_Linux_in_VMware" target="_blank" rel="external">Arch-wiki - Installing Arch Linux in VMware</a> - From the official Wiki. </li>
<li><a href="https://wiki.archlinux.org/index.php/pacman#Installing_packages" target="_blank" rel="external">Arch-wiki Pacman Package Manager</a> - Example commands and switches.</li>
<li><a href="https://wiki.archlinux.org/index.php/Systemd#Using_units" target="_blank" rel="external">Arch-wiki - systemd</a> - Using units (systemctl).</li>
<li><a href="https://wiki.archlinux.org/index.php/Xorg" target="_blank" rel="external">Arch-wiki Xorg Server</a> - Full details on Xorg. </li>
<li><a href="http://lifehacker.com/5680453/build-a-killer-customized-arch-linux-installation-and-learn-all-about-linux-in-the-process" target="_blank" rel="external">Lifehacker Article on Arch Installation</a> - Not for a VM image but useful.</li>
<li><a href="http://www.linuxveda.com/2014/06/07/arch-linux-tutorial/" target="_blank" rel="external">Linux Neda: How to install Arch Linux</a> - Similar to the previous article but also useful. </li>
</ul>
<blockquote>
<p>Easily deploy an SSD cloud server on <a href="https://www.digitalocean.com/?refcode=e91058dbfc7b" target="_blank" rel="external">Digital Ocean</a> in 55 seconds. Sign up using my link and receive $10.00 in free credit: <a href="https://www.digitalocean.com/?refcode=e91058dbfc7b" target="_blank" rel="external">https://www.digitalocean.com/?refcode=e91058dbfc7b</a></p>
</blockquote>
<p>– Scarlz: <a href="https://twitter.com/5car1z" target="_blank" rel="external">@5car1z</a></p>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/Arch/" class="post__tag__link">Arch</a></li><li class="post__tag__item"><a href="/tags/VM/" class="post__tag__link">VM</a></li><li class="post__tag__item"><a href="/tags/Shell/" class="post__tag__link">Shell</a></li></ul><a href="/2015/02/18/arch-vm-main/#disqus_thread" class="post__foot-link u-fr">COMMENTS</a></footer></article><article class="post"><header class="post__head"><time datetime="2015-02-16T00:00:00.000Z" class="post__time">February 16, 2015</time><h1 class="post__title"><a href="/2015/02/16/arch-vm-base/">Arch Linux VM Base Installation</a></h1></header><div class="post__main echo"><p><img src="http://i.imgur.com/v5cFEBC.png" alt="Arch Linux Logo"></p>
<p>I setup the base system components of Arch on a VM recently, here are the notes on one of the many ways of doing this.</p>
<p>So bear in mind that these notes in places are relative to me.    </p>
<blockquote>
<p><a href="https://www.archlinux.org/download/" target="_blank" rel="external">Arch Linux Source Download Page</a></p>
</blockquote>
<a id="more"></a>
<hr>
<h1 id="1-–-Initial-Shell-Prompt"><a href="#1-–-Initial-Shell-Prompt" class="headerlink" title="1 – Initial Shell Prompt"></a>1 – Initial Shell Prompt</h1><p>After being presented with a shell prompt where you are automatically logged in as <em>root</em>. Begin by setting the keyboard language to your relevant country. </p>
<p><strong>The shell in use is Zsh.</strong></p>
<p>Show the possible keyboard layouts available with this command. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ localectl list-keymaps</span><br></pre></td></tr></table></figure>
<p>To set it use <code>loadkeys</code> plus your keyboard layout choice:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ loadkeys uk</span><br></pre></td></tr></table></figure>
<p>The <em>dhcpcd</em> network daemon starts automatically during boot, and it will attempt to start a wired connection by default. </p>
<p>Use <code>ping</code> to check connectivity. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ping -c 5 www.google.co.uk</span><br></pre></td></tr></table></figure>
<p>In a Virtual Machine that shares the host’s network connection, the <code>ping</code> should be successful as long as the host itself is connected and working, when using a <em>bridged</em> hardware network setting. If not this then… improvise.</p>
<hr>
<h1 id="2-–-Partitioning"><a href="#2-–-Partitioning" class="headerlink" title="2 – Partitioning"></a>2 – Partitioning</h1><p>This will list all devices connected to your system along with their partition schemes, including those used to host and boot live Arch installation media (e.g. a USB drive). Not all devices listed will therefore be viable or appropriate mediums for installation. To filter out inappropriate results, use this <code>grep</code>. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ lsblk | grep -v <span class="string">"rom\|loop\|airoot"</span></span><br></pre></td></tr></table></figure>
<p>Devices (e.g. hard drives) will be listed as <em>sdx</em>, where <em>x</em> is a lower-case letter starting from <em>a</em> for the first device (<em>sda</em>), <em>b</em> for the second device (<em>sdb</em>), and so on. For the VM only one device is available (<em>sda</em>) which is the allocated host hard drive space.</p>
<p>Open the device (host HDD) that the partition table is to be created with and create a new <em>MBR</em>/<em>msdos</em> partition table for BIOS systems. All done using the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ parted <span class="_">-s</span> /dev/sda mktable msdos</span><br></pre></td></tr></table></figure>
<p>Here I’m making two partitions in total for the VM. The first with line <code>1</code> and second with line <code>2</code>. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ parted <span class="_">-s</span> /dev/sda mkpart primary 0% 100m</span><br><span class="line">$ parted <span class="_">-s</span> /dev/sda mkpart primary 100m 100%</span><br></pre></td></tr></table></figure>
<p>You can run the earlier <code>grep</code> pattern again to see the newly created partitions. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ lsblk | grep -v <span class="string">"rom\|loop\|airoot"</span></span><br></pre></td></tr></table></figure>
<p>Or use <code>parted</code> instead to see the partition table.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ parted /dev/sda <span class="built_in">print</span></span><br></pre></td></tr></table></figure>
<hr>
<h1 id="3-–-Filesystems"><a href="#3-–-Filesystems" class="headerlink" title="3 – Filesystems"></a>3 – Filesystems</h1><p><code>/boot</code></p>
<p>The boot filesystem is formatted and placed on the first partition created (smaller of the two) with:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mkfs.ext2 /dev/sda1</span><br></pre></td></tr></table></figure>
<p><code>/</code></p>
<p>The root filesystem is formatted on the other main partition now via:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mkfs.btrfs /dev/sda2</span><br></pre></td></tr></table></figure>
<h1 id="4-–-Mounting"><a href="#4-–-Mounting" class="headerlink" title="4 – Mounting"></a>4 – Mounting</h1><p><code>/mnt/</code></p>
<p>This will <em>mount</em> the main partition:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mount /dev/sda2 /mnt/</span><br></pre></td></tr></table></figure>
<p>Make a boot directory in <code>/mnt/</code> which is now mapped/mounted to <code>/dev/sda2</code> .</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir /mnt/boot</span><br></pre></td></tr></table></figure>
<p>Mount the boot partition to the newly created boot sub-directory in the main root partition.  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mount /dev/sda1 /mnt/boot</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="5-–-Mirrors-amp-System-Packages"><a href="#5-–-Mirrors-amp-System-Packages" class="headerlink" title="5 – Mirrors &amp; System Packages"></a>5 – Mirrors &amp; System Packages</h1><p>Begin by appending the system’s <em>mirrorlist</em> file name with <strong>.orig</strong> and the <code>mv</code> command.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mv /etc/pacman.d/mirrorlist /etc/pacman.d/mirrorlist.orig</span><br></pre></td></tr></table></figure>
<p>Then run <code>rankmirrors</code> on the aforementioned file with the <code>-n</code> parameter to find and redirect the fastest <strong>6</strong> mirrors into a new <em>mirrorlist</em> file.  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rankmirrors -n 6 /etc/pacman.d/mirrorlist.orig &gt;/etc/pacman.d/mirrorlist</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>Note:</strong> This takes several minutes to process and complete, have faith and wait…  </p>
</blockquote>
<p>After this use <code>pacman</code> to update and sync the systems package listings. </p>
<p><strong>“Whenever you change your mirrorlist, refresh all package lists with pacman, to ensure that the package lists are updated consistently.”</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pacman -Syy</span><br></pre></td></tr></table></figure>
<p>Next install all the system’s base packages. Time to download packages will vary on your internet connection and the respective mirrors. </p>
<p>Adding a <code>-i</code> parameter to this command enables a prompt for every package to be installed during the process, if preferred.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pacstrap /mnt/ base base-devel</span><br></pre></td></tr></table></figure>
<p>Copy the mirrorlist(s) from earlier over also.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cp /etc/pacman.d/mirrorlist* /mnt/etc/pacman.d</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="6-–-fstab"><a href="#6-–-fstab" class="headerlink" title="6 – fstab"></a>6 – fstab</h1><p>Here generate fstab like so in this directory:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ genfstab -p /mnt/ &gt;&gt;/mnt/etc/fstab</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="7-–-chroot"><a href="#7-–-chroot" class="headerlink" title="7 – chroot"></a>7 – chroot</h1><p><code>chroot</code> into a bash shell in <code>/mnt/</code> .</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ arch-chroot /mnt/ /bin/bash</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="8-–-hostname"><a href="#8-–-hostname" class="headerlink" title="8 – hostname"></a>8 – hostname</h1><p>Set the <code>hostname</code> to today’s date, or whatever you prefer. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">"archlinux-vm-<span class="variable">$(date +"%d-%m-%y")</span>"</span> &gt;/etc/hostname</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="9-–-localtime"><a href="#9-–-localtime" class="headerlink" title="9 – localtime"></a>9 – localtime</h1><p>Set the <code>localtime</code> to London’s current time (obviously change this in relation to your own timezone.) </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ln <span class="_">-s</span> /usr/share/zoneinfo/Europe/London /etc/localtime</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="10-–-locale"><a href="#10-–-locale" class="headerlink" title="10 – locale"></a>10 – locale</h1><p><em>Locales</em> define which language the system uses and other regional considerations like currency denomination, numerology and character sets. </p>
<p>Using <code>vi</code> do this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi /etc/locale.gen</span><br></pre></td></tr></table></figure>
<p>Uncomment the relevant language you wish to use (UTF-8 support recommended).</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">en_GB.UTF-8 UTF-8</span><br></pre></td></tr></table></figure>
<p>Then generate the <em>locales</em> .</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ locale-gen</span><br></pre></td></tr></table></figure>
<p>The <code>/etc/locale.conf</code> file does not exist by default. Create it, where <code>LANG</code> refers to the first uncommented entry in <code>/etc/locale.gen</code> from earlier. </p>
<p>See the next command for an example:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> LANG=en_GB.UTF-8 &gt; /etc/locale.conf</span><br></pre></td></tr></table></figure>
<p>Lastly export the chosen <em>locale</em>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> LANG=en_GB.UTF-8</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="11-–-passwd"><a href="#11-–-passwd" class="headerlink" title="11 – passwd"></a>11 – passwd</h1><p>Change the root user’s password for the VM.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ passwd</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="12-–-GRUB-Bootloader"><a href="#12-–-GRUB-Bootloader" class="headerlink" title="12 – GRUB Bootloader"></a>12 – GRUB Bootloader</h1><p>Here installation with GRUB and <em>MBR/msdos</em> is demonstrated. </p>
<p>Install the <code>grub</code> package and then run <code>grub-install</code> to install the bootloader:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ pacman -S grub</span><br><span class="line">$ grub-install --target=i386-pc --recheck /dev/sda</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>Warning:</strong> Change <code>/dev/sda</code> to reflect the drive you installed Arch on if needed. Do not append a partition number, and do not replace it with “sdax” either.</p>
</blockquote>
<p>Next automatically generate the main grub config file.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ grub-mkconfig -o /boot/grub/grub.cfg</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="13-–-unmount-amp-reboot"><a href="#13-–-unmount-amp-reboot" class="headerlink" title="13 – unmount &amp; reboot"></a>13 – unmount &amp; reboot</h1><p>Exit from the <em>chrooted</em> shell environment:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">exit</span></span><br></pre></td></tr></table></figure>
<p>While partitions are unmounted automatically by <em>systemd</em> on shutdown, you may do so manually with the next command as a safety measure. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ umount -R /mnt/</span><br></pre></td></tr></table></figure>
<p>Finally if using a CD image you may have to remove it from your VM manager software, before rebooting.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ reboot</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>“Your new Arch Linux base system is now a functional GNU/Linux environment ready to be built into whatever you wish or require.”</strong></p>
</blockquote>
<hr>
<p><strong>More Information</strong></p>
<ul>
<li><a href="https://wiki.archlinux.org/index.php/Beginners%27_guide" target="_blank" rel="external">Arch Linux Beginner’s Guide</a> - From the official Wiki. </li>
<li><a href="http://www.wuputah.com/2013/02/18/quickly-install-an-archlinux-vm-in-15-minutes/" target="_blank" rel="external">wuputah.musings</a> - Quickly Install an Arch Linux VM in 15 minutes.</li>
<li><a href="https://www.archlinux.org/mirrors/status/" target="_blank" rel="external">Arch Linux Mirror Status</a> - Reports various aspects about the mirrors such as network problems with mirrors, data collection problems, the last time mirrors have been synced, etc.</li>
<li><a href="https://wiki.archlinux.org/index.php/GRUB" target="_blank" rel="external">Arch Linux GRUB Article</a> - For more information on configuring and using GRUB, see GRUB.</li>
</ul>
<blockquote>
<p>Easily deploy an SSD cloud server on <a href="https://www.digitalocean.com/?refcode=e91058dbfc7b" target="_blank" rel="external">Digital Ocean</a> in 55 seconds. Sign up using my link and receive $10.00 in free credit: <a href="https://www.digitalocean.com/?refcode=e91058dbfc7b" target="_blank" rel="external">https://www.digitalocean.com/?refcode=e91058dbfc7b</a></p>
</blockquote>
<p>– Scarlz: <a href="https://twitter.com/5car1z" target="_blank" rel="external">@5car1z</a></p>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/Arch/" class="post__tag__link">Arch</a></li><li class="post__tag__item"><a href="/tags/VM/" class="post__tag__link">VM</a></li><li class="post__tag__item"><a href="/tags/Shell/" class="post__tag__link">Shell</a></li></ul><a href="/2015/02/16/arch-vm-base/#disqus_thread" class="post__foot-link u-fr">COMMENTS</a></footer></article><article class="post"><header class="post__head"><time datetime="2015-02-05T00:00:00.000Z" class="post__time">February 5, 2015</time><h1 class="post__title"><a href="/2015/02/05/zsh-basic-configuration/">Ubuntu 14.04 Z Shell (zsh) Installation and Basic Configuration</a></h1></header><div class="post__main echo"><p><img src="http://i.imgur.com/OyNFwff.gif" alt="Z Shell Logo"></p>
<p>Initial notes on installing plus base setup of Z Shell. </p>
<p>Listed here are some of its often touted features. </p>
<ul>
<li>Auto-completion </li>
<li>Auto-correction</li>
<li>Scripting capabilities</li>
<li>Extensibility with modules</li>
<li>Improved globbing</li>
<li>Improved array handling</li>
</ul>
<a id="more"></a>
<hr>
<h1 id="1-–-Installation"><a href="#1-–-Installation" class="headerlink" title="1 – Installation"></a>1 – Installation</h1><p>Update the <code>apt-get</code> package manager’s database.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br></pre></td></tr></table></figure>
<p>Install <code>zsh</code> through the <code>apt-get</code> package manager.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install zsh</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="2-–-zsh-newuser-install"><a href="#2-–-zsh-newuser-install" class="headerlink" title="2 – zsh-newuser-install"></a>2 – zsh-newuser-install</h1><p>Run Z Shell for the first time to begin the new user config.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ zsh</span><br></pre></td></tr></table></figure>
<p>If it doesn’t run or drop into the config then you can use:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ zsh /usr/share/zsh/<span class="built_in">functions</span>/Newuser/zsh-newuser-install <span class="_">-f</span></span><br></pre></td></tr></table></figure>
<p>Which will invoke the new user config manually.</p>
<p>Work through the new prompt screen as directed, typing <code>0</code> remembers an edit but does not save it until it is entered again on the root prompt screen.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(1)  Configure settings <span class="keyword">for</span> <span class="built_in">history</span>, i.e. <span class="built_in">command</span> lines remembered</span><br><span class="line">     and saved by the shell.  (Recommended)</span><br></pre></td></tr></table></figure>
<p>On the first option <code>0</code> will suffice and keeps the default settings.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(2)  Configure the new completion system.  (Recommended.)</span><br></pre></td></tr></table></figure>
<p>On the second option pressing <code>1</code> and turning on completion with default options is enough.  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(3)  Configure how keys behave when editing <span class="built_in">command</span> lines.  (Recommended.)</span><br></pre></td></tr></table></figure>
<p>With the third option you can set the key’s shell line editor to behave like Emacs or Vi. Set it with <code>1</code> and press <code>e</code> for emacs and <code>v</code> for vi.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(4)  Pick some of the more common shell options.  These are simple <span class="string">"on"</span></span><br><span class="line">     or <span class="string">"off"</span> switches controlling the shell<span class="string">'s features.</span></span><br></pre></td></tr></table></figure>
<p>In the fourth option I set <strong>1, 2, and 3</strong> to on, enabling them. </p>
<p>Finally entering <code>0</code> at the root menu exits and saves these new settings.</p>
<hr>
<h1 id="3-–-Configuration-Files-Layout"><a href="#3-–-Configuration-Files-Layout" class="headerlink" title="3 – Configuration Files Layout"></a>3 – Configuration Files Layout</h1><p>When Z Shell starts, it sources the following files in this order:</p>
<p><code>/etc/zsh/zshenv</code><br>Commands to set the global command search path and other system-wide environment variables; it should not contain commands that produce output.</p>
<p><code>~/.zshenv</code><br>For per-user configuration. Generally used for setting some useful environment variables.</p>
<p><code>/etc/zsh/zprofile</code><br>This is a global configuration file, usually used for executing some general commands at login. On Arch Linux, by default it contains one line which sources the /etc/profile.</p>
<p><code>/etc/profile</code><br>This file should be sourced by all Bourne-compatible shells upon login: it sets up an environment upon login and application-specific settings. Again on Arch Linux, Z Shell will also source this by default.</p>
<p><code>~/.zprofile</code><br>This file is generally used for automatic execution of user scripts upon login.</p>
<p><code>/etc/zsh/zshrc</code><br>Another global configuration file. </p>
<p><code>~/.zshrc</code><br>The main user configuration file, and the one most often customised by users. This file is the one that will be used and changed in the next section. </p>
<p><code>/etc/zsh/zlogin</code><br>Another global configuration file.</p>
<p><code>~/.zlogin</code><br>Same as the previous file before it, except for individual-user configuration.</p>
<p><code>/etc/zsh/zlogout</code><br>A global configuration file, will be sourced when a login shell exits.</p>
<p><code>~/.zlogout</code><br>Same as the previous file before it, except for individual-user configuration.</p>
<h1 id="4-–-zshrc-Configuration-File"><a href="#4-–-zshrc-Configuration-File" class="headerlink" title="4 – .zshrc Configuration File"></a>4 – .zshrc Configuration File</h1><p>The newly created <code>zsh</code> config file contents we just defined can be seen by opening it with a text editor. I’m using <code>vim</code> in this example. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>At the end of the config file append the following:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">autoload</span> -U promptinit compinit</span><br><span class="line">promptinit</span><br><span class="line">compinit</span><br><span class="line">prompt bart</span><br></pre></td></tr></table></figure>
<p>Where <code>bart</code> is the name of the prompt you wish to use in your Z shell. For my example here I chose the bart theme.</p>
<p>To see possible prompts available and installed follow these commands from a Z shell terminal prompt. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">autoload</span> -U promptinit</span><br><span class="line">$ promptinit</span><br><span class="line">$ prompt p</span><br></pre></td></tr></table></figure>
<p>To apply any changes immediately in the config file you can use:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>Or exit and invoke a new Z Shell session.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">exit</span></span><br><span class="line">$ zsh</span><br></pre></td></tr></table></figure>
<p>Finally to make Z Shell your Linux user’s <strong>default</strong> shell on this account enter:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chsh <span class="_">-s</span> $(<span class="built_in">which</span> zsh)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>Note:</strong> Do not include <code>sudo</code> with this previous command as it will alter the <em>root</em> user’s default shell instead. </p>
</blockquote>
<p>The <code>$SHELL</code> variable stores your user’s current default shell path. It can be used to confirm the set default shell.  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$SHELL</span></span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Alternative-Method-via-oh-my-zsh"><a href="#Alternative-Method-via-oh-my-zsh" class="headerlink" title="Alternative Method via oh-my-zsh"></a>Alternative Method via oh-my-zsh</h1><blockquote>
<p>Oh-My-Zsh is an open source, community-driven framework for managing your ZSH configuration. It comes bundled with a ton of helpful functions, helpers, plugins, themes, and a few things that make you shout…</p>
</blockquote>
<p>Instead of a manual setup many people choose to use <a href="http://ohmyz.sh/" target="_blank" rel="external">oh-my-zsh</a> to manage their zsh installations.</p>
<p>It can be acquired most easily by using either <code>curl</code> <strong>or</strong> <code>wget</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -L http://install.ohmyz.sh | sh</span><br></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ wget --no-check-certificate http://install.ohmyz.sh -O - | sh</span><br></pre></td></tr></table></figure>
<p>Enable any of the plugins you want in your <code>~/.zshrc</code> config file by setting them active:</p>
<figure class="highlight bash"><figcaption><span>~/.zshrc </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plugins=(git ruby)</span><br></pre></td></tr></table></figure>
<p>Change the <code>ZSH_THEME</code> environment variable in your <code>~/.zshrc</code> to enable any of themes included in the package. </p>
<figure class="highlight bash"><figcaption><span>~/.zshrc </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZSH_THEME=<span class="string">"af-magic"</span></span><br></pre></td></tr></table></figure>
<p>Furthermore you can <em>uncomment</em> any disabled options in this file if you want them active and enabled. </p>
<hr>
<p><strong>More Information</strong></p>
<ul>
<li><a href="http://zsh.sourceforge.net/FAQ/zshfaq01.html#l8" target="_blank" rel="external">I don’t have root access: how do I make zsh my login shell?</a></li>
<li><a href="https://wiki.archlinux.org/index.php/Zsh" target="_blank" rel="external">Z Shell Arch Linux Wiki Page</a></li>
<li><a href="https://github.com/robbyrussell/oh-my-zsh/" target="_blank" rel="external">oh-my-zsh on Github</a></li>
<li><a href="http://www.bash2zsh.com/zsh_refcard/refcard.pdf" target="_blank" rel="external">zsh Reference Card</a></li>
</ul>
<blockquote>
<p>Easily deploy an SSD cloud server on <a href="https://www.digitalocean.com/?refcode=e91058dbfc7b" target="_blank" rel="external">Digital Ocean</a> in 55 seconds. Sign up using my link and receive $10.00 in free credit: <a href="https://www.digitalocean.com/?refcode=e91058dbfc7b" target="_blank" rel="external">https://www.digitalocean.com/?refcode=e91058dbfc7b</a></p>
</blockquote>
<p>– Scarlz: <a href="https://twitter.com/5car1z" target="_blank" rel="external">@5car1z</a></p>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/Ubuntu/" class="post__tag__link">Ubuntu</a></li><li class="post__tag__item"><a href="/tags/Shell/" class="post__tag__link">Shell</a></li><li class="post__tag__item"><a href="/tags/zsh/" class="post__tag__link">zsh</a></li></ul><a href="/2015/02/05/zsh-basic-configuration/#disqus_thread" class="post__foot-link u-fr">COMMENTS</a></footer></article></main><footer class="foot"><div class="foot-copy u-fl">&copy; 2018 Scarlz</div><menu class="page-menu u-fr"><li class="page-menu__item"><span title="Previous" class="page-menu__link icon-arrow-left page-menu__link--disabled"></span></li><li class="page-menu__item"><span title="Next" class="page-menu__link icon-arrow-right page-menu__link--disabled"></span></li></menu></footer><script>(function(h,g,l,k,j,i){j=h.createElement(g),i=h.getElementsByTagName(g)[0],
j.src="//"+l+".disqus.com/"+k+".js",i.parentNode.insertBefore(j,i)})
(document,"script","totts","count");
</script></body></html>